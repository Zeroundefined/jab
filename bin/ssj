#! /bin/bash

# ssj : run sst using jab's public key

PATH_TO_SCRIPT=$(readlink -f $BASH_SOURCE)
PATH_TO_SCRIPTS=$(dirname $PATH_TO_SCRIPT)

source ~/.jab/jab_environ

usage ()
{
	ARGS="$*"
	if [[ $# != 2 ]]
	then
		if [[ $# == 1 ]]
		then
			parts=$(echo $1 | tr '@' '\n' | wc -l)
			if [[ $parts -eq 1 ]]
			then
				ARGS=$USER@$1
			elif [[ $parts -ne 2 ]]
			then
				echo "usage: $PATH_TO_SCRIPT <username> <server>" >&2
				exit 1
			fi
		fi
	fi
}

main ()
{
	$PATH_TO_SCRIPTS/sst $ARGS -i $JAB_KEY
}

usage $*
main $*
